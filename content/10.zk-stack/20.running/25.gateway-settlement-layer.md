---
title: ZKsync Gateway settlement layer
description:
---

ZKsync Gateway is an **optional settlement layer** for ZK chains, including both rollups and validiums. It is purpose-built to
enhance **interoperability**, provide **proof aggregation**, and offer **cost efficiencies** for chains that wish to settle on top of it.

[Learn more about ZKsync Gateway](../../zksync-protocol/gateway/overview) in the protocol documentation.

## Running ZKsync Gateway locally

::callout{icon="i-heroicons-exclamation-triangle" color="amber"}
This guide assumes you already have an ecosystem with a ZK chain settling on L1 [as detailed in the quickstart](./quickstart).
::

1. Create a new ZK chain that will become your local gateway chain:

    ```bash
    zkstack chain create \
        --chain-name gateway \
        --chain-id 506 \
        --prover-mode no-proofs \
        --wallet-creation localhost \
        --l1-batch-commit-data-generator-mode rollup \
        --base-token-address 0x0000000000000000000000000000000000000001 \
        --base-token-price-nominator 1 \
        --base-token-price-denominator 1 \
        --set-as-default false \
        --evm-emulator false \
        --ignore-prerequisites --update-submodules false
    ```

1. Initialise `gateway` chain:

    ```bash
    zkstack chain init \
      --deploy-paymaster \
      --l1-rpc-url=http://localhost:8545 \
      --server-db-url=postgres://postgres:notsecurepassword@localhost:5432 \
      --server-db-name=zksync_server_localhost_gateway \
      --chain gateway --update-submodules false
    ```

1. Transform `gateway` chain from rollup into a ZKsync Gateway settlement layer:

    ```bash
    zkstack chain gateway convert-to-gateway --chain gateway --ignore-prerequisites
    ```

1. Start `gateway` chain server:

    ```bash
    mkdir zlogs
    zkstack server --ignore-prerequisites --chain gateway &> ./zlogs/gateway.log &
    ```

1. Migrate existing ZK chain to settle on `gateway`:

    ```bash
    zkstack chain gateway migrate-to-gateway --chain YOUR_CHAIN_NAME --gateway-chain-name gateway
    ```

1. Start your chain server:

    ```bash
    zkstack server --ignore-prerequisites --chain YOUR_CHAIN &> ./era.log &
    ```

## Migrate existing ZK chain to Gateway on testnet or mainnet

ZK chains can be migrated to use ZKsync Gateway as their settlement layer by updating the chain's metadata and
coordinating the transition with off-chain services.
This migration is performed using the [`zkstack cli`](https://github.com/matter-labs/zksync-era/blob/main/zkstack_cli/README.md) tool.

### Overview of Migration Steps

1. **Prepare your environment**
   - Ensure the target Gateway environment is deployed and accessible.
   - Verify you have admin access (EOA or multisig) to the chain you are migrating.

2. **Notify the server**
   - Use `zkstack cli` to generate calldata that informs your chain server that a migration is about to happen.
   - This ensures the server components (node, prover, etc.) properly transition to using Gateway.

3. **Generate and execute migration calldata**
   - Use `zkstack cli` to generate the calldata required to update the chainâ€™s `settlement_chain_id` and related configuration.
   - Execute the calldata onchain using your multisig or admin wallet.

4. **Deploy or reconfigure DA validators**
   - If needed, deploy your DA validator contracts to Gateway and update references in the chain configuration.
   - See [Gateway DA considerations](../../zksync-protocol/gateway/da-considerations) for details.

5. **Verify migration**
   - Confirm that settlement is routed through Gateway.
   - Check that `settlementLayer(chainId)` on the
  [Bridgehub contract](https://sepolia.etherscan.io/address/0x35A54c8C757806eB6820629bc82d90E056394C92#readProxyContract) returns `506` (testnet)
  or `9075` (mainnet).
   - Monitor batch submission and DA behavior post-migration.

### CLI Reference

For exact commands and calldata generation details, refer to the official [zkstack cli migration guide](https://github.com/matter-labs/zksync-era/blob/main/zkstack_cli/README.md#migrating-to-and-from-gateway).
